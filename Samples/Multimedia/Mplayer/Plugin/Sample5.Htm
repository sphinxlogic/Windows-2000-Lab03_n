<HTML>
<HEAD>
<TITLE>NetShow SDK Sample 5 - Advanced scripting - One page fits all</TITLE>
</HEAD>
<BODY onload="InitializePage()">  <!-- NOTE: onload() is Navigator specfic and required for events -->

<!-- BEGIN GENERIC ALL BROWSER FRIENDLY HTML FOR NETSHOW V3 -->
<OBJECT ID="NSPlay" width=320 height=240 classid="CLSID:22D6F312-B0F6-11D0-94AB-0080C74C7E95"
        codebase="http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=5,1,52,701"
        standby="Loading Microsoft Media Player components..." type="application/x-oleobject">
        <PARAM name="FileName" value="demo.asf">
        <EMBED type="application/x-mplayer2"
               pluginspage="http://www.microsoft.com/Windows/Downloads/Contents/Products/MediaPlayer/"
               filename="demo.asf"
               name="NSPlay"
               width=320
               height=240
        ></EMBED>
</OBJECT>
<BR>
<A href="demo.asf">Start the NetShow presentation in the stand-alone player.</A>
<!-- END GENERIC ALL BROWSER FRIENDLY HTML FOR NETSHOW V3 RTM -->

<H4><FONT FACE="VERDANA">Use Buttons to Change NetShow Control Parameters.<br>To begin, click 'Play'.</H4></FONT>
<HR>
<FONT FACE="VERDANA" SIZE=2>

<FORM name="myform">
    <P>
	    <INPUT type=button value="No Controls" name="NoControls" OnClick="controlType(false)"></td>
	    <INPUT type=button value="All Controls" name="Full" Onclick="controlType(true)"></td>
	    <BR>
	    <INPUT type=button value="   Small   " name="Small" OnClick="displaySize(1)"  ></TD>
	    <INPUT type=button value="   Large   " name="Large" Onclick="displaySize(2)"  ></TD>
	    <INPUT type=button value="  Normal   " name="Normal" Onclick="displaySize(0)" ></TD>
	    <BR>
	    <INPUT type=button value="   Play    " name="Play" Onclick="PlayClick()"      ></TD>
	    <INPUT type=button value="   Pause   " name="Pause" Onclick="PauseClick()"    ></TD>
	    <INPUT type=button value="   Stop    " name="Stop" Onclick="StopClick()"      ></p></TD>

	    button to toggle between play and pause:
	    <INPUT type="button" value="   Pause   " name="PlayPause" Onclick="PlayPauseClick()">
    <P>
</FORM>

<HR>
<FONT FACE="VERDANA" SIZE=1><I>Browser Requirements: Internet Explorer 4.x/Netscape Navigator 4.x</I></FONT>
<HR>
</P>
<!-- ********** BEGIN NAVIGATOR SPECIFIC ********** -->
<SCRIPT language=javascript src="evt_cmd.js"></SCRIPT>
<SCRIPT language=javascript src="evt_psc.js"></SCRIPT>
<SCRIPT language=javascript src="evt_rsc.js"></SCRIPT>
<SCRIPT language="javascript">
<!--
// ********************* BEGIN NETSCAPE SPECIFIC BLOCK - NETSHOW V3 *********************
//
// This block ensures the APPLET tag is set in the document to handle events.
// Recently installed plug-ins are refreshed.
//
// NOTE: If event processing is un-necessary, this should not be used.
//
document.write("\x3C" +"applet MAYSCRIPT Code=NPDS.npDSEvtObsProxy.class" );
document.writeln(" width=5 height=5 name=appObs\x3E" + "\x3C/" + "applet\x3E");

// This next line ensures that any plugins just installed are updated in the Browser
// without quitting the browser.
//
navigator.plugins.refresh();

function RegisterEventObservers ()
{
    var pluginJavaPeerRef = document.NSPlay;
    document.appObs.setByProxyDSScriptCommandObserver(pluginJavaPeerRef, true);
    document.appObs.setByProxyDSPlayStateChangeObserver(pluginJavaPeerRef, true);
    document.appObs.setByProxyDSReadyStateChangeObserver(pluginJavaPeerRef, true);

}   /*  end RegisterEventObservers() */
// ********************* END NETSCAPE SPECIFIC BLOCK - NETSHOW V3 *********************
//-->
</SCRIPT>
<!-- ********** END NAVIGATOR SPECIFIC ********** -->

<!-- ********** BEGIN ALL BROWSER ********** -->
<SCRIPT language=javascript>
<!--
var g_Browser = navigator.appName;

function InitializePage ()
{
    // Only need to do this for Navigator!

    if (g_Browser == "Netscape")
        RegisterEventObservers();

}   /* end InitializePage() */


function controlType (setting)
{
    if (g_Browser == "Netscape")
      	document.NSPlay.SetShowControls(setting);
    else
        document.NSPlay.ShowControls = setting;

}   /* end controlType() */


function displaySize (setting)
{
    if (g_Browser == "Netscape")
        document.NSPlay.SetDisplaySize(setting);
    else
        document.NSPlay.DisplaySize = setting;

}   /* end displaySize() */


function PlayClick ()
{
    document.NSPlay.Play();

}   /* end PlayClick() */


function StopClick ()
{
    document.NSPlay.Stop();
    
    if (g_Browser == "Netscape")
        document.NSPlay.SetCurrentPosition(0);
    else
        document.NSPlay.CurrentPosition = 0;

}   /* end StopClick() */


function PauseClick ()
{
    document.NSPlay.Pause();

}   /* end PauseClick() */


function PlayPauseClick ()
{
    var state;
    
    if (g_Browser == "Netscape")
        state = document.NSPlay.GetPlayState();
    else
        state = document.NSPlay.PlayState;

    if (state == 0) {
        document.NSPlay.Play();
        document.myform.PlayPause.value = "Pause";
    } else if (state == 1) {
        document.NSPlay.Play();
        document.myform.PlayPause.value = "Pause";
    } else if (state == 2) {
        document.NSPlay.Pause();
        document.myform.PlayPause.value = " Play";
    }

}   /* end PlayPauseClick() */
//-->
</SCRIPT>
<!-- ********** END ALL BROWSER ********** -->

<!-- **********  BEGIN INTERNET EXPLORER SPECIFIC ********** -->
<SCRIPT language="VBScript">
<!--
Sub NSPlay_PlayStateChange (OldState, NewState)
    MsgBox "IE: PlayStateChange: " & OldState & ", " & NewState
End Sub

Sub NSPlay_ReadyStateChange (ReadyState)
    If (ReadyState = 3) Or (ReadyState = 4) Then
        MsgBox "IE: ReadyStateChange: " & CStr(ReadyState)
    End if
End Sub

Sub NSPlay_ScriptCommand (scType, scParam)
    MsgBox "IE: ScriptCommand: " & scType & ", " & scParam
End Sub
//-->
</SCRIPT>
<!-- ********** END INTERNET EXPLORER SPECIFIC ********** -->

</BODY>
</HTML>

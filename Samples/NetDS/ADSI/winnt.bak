<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Active Directory Service Interfaces 2.5 - WinNT</title>
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
</head>

<body topmargin="0" leftmargin="0">

<table border="0" height="86" cellpadding="0" cellspacing="0">
  <tr>
    <td width="77%" valign="top" height="58"><img src="banner.gif" alt="banner.gif (5982 bytes)" width="250" height="60"></td>
    <td width="3%" height="58"></td>
    <td width="21%" height="58" valign="bottom"><p align="right"><img src="mslogo.gif" alt="mslogo.gif (666 bytes)" width="112" height="40"></td>
  </tr>
  <tr>
    <td valign="top" align="left" height="28"><!--webbot bot="ImageMap" rectangle="(420,1) (515, 18)  rtk.htm" rectangle="(350,1) (415, 19)  interopt.htm" rectangle="(233,1) (345, 19)  ad.htm" rectangle="(165,1) (223, 19)  winnt.htm" rectangle="(67,1) (165, 19)  dev.htm" rectangle="(13,1) (65, 20)  default.htm" src="router.gif" alt="router.gif (3874 bytes)" border="0" startspan --><MAP NAME="FrontPageMap"><AREA SHAPE="RECT" COORDS="420, 1, 515, 18" HREF="rtk.htm"><AREA SHAPE="RECT" COORDS="350, 1, 415, 19" HREF="interopt.htm"><AREA SHAPE="RECT" COORDS="233, 1, 345, 19" HREF="ad.htm"><AREA SHAPE="RECT" COORDS="165, 1, 223, 19" HREF="winnt.htm"><AREA SHAPE="RECT" COORDS="67, 1, 165, 19" HREF="dev.htm"><AREA SHAPE="RECT" COORDS="13, 1, 65, 20" HREF="default.htm"></MAP><a href="_vti_bin/shtml.dll/winnt.htm/map"><img ismap usemap="#FrontPageMap" border="0" height="26" alt="router.gif (3874 bytes)" src="router.gif" width="536"></a><!--webbot bot="ImageMap" endspan i-checksum="47999" --></td>
    <td width="3%" height="28"></td>
    <td width="21%" height="28"></td>
  </tr>
</table>

<table border="0" width="100%" cellspacing="0" cellpadding="0" height="103">
  <tr>
    <td width="3%" height="82"></td>
    <td width="97%" height="82"><img src="winnt.gif" alt="winnt.gif (3693 bytes)" width="201" height="80"></td>
  </tr>
  <tr>
    <td width="3%" height="21"></td>
    <td width="97%" height="21"><small><font face="Verdana">ADSI WinNT provider allows you to
    communicate to NT 4.0 directory. Since, Windows 2000 maintains backward compatiblity, you
    can also communicate with Windows 2000 machines using WinNT. However, we recommend to use
    the LDAP provider to communicate with Windows 2000 domain controllers. For Windows 2000
    stand alone Server and Professional Edition, you must use the WinNT provider to access the
    directory.</font></small><p><small><font face="Verdana">WinNT supports local and remote
    account, service, computer, security management and other functionalities. With ADSI 2.5
    Extension, you'll be able to extend the functionality. For more information on extension,
    click <a href="extend.htm">here</a>.</font></small></p>
    <p><strong><font face="Verdana" color="#0080C0"><small>Requirements</small></font></strong><ul>
      <li><font face="Verdana"><small>Install ADSI 2.5. To download the runtime, visit<a href="http://www.microsoft.com/adsi"> http://www.microsoft.com/adsi</a> on NT 4.0 or
        Win95. Note, if you have Windows 2000 machine, you don't need to install ADSI. ADSI is one
        of Windows 2000 built-in components.</small><br>
        </font></li>
      <li><small><font face="Verdana">You must have NT 4.0 or Windows 2000 or higher to connect
        to. Client and server may be on the same machine.</font></small></li>
    </ul>
    <ul>
      <li><small><font face="Verdana">Set up your <a href="dev.htm">development environment</a>.</font></small></li>
    </ul>
    <p>&nbsp;</p>
    <p><font face="Verdana" color="#0080C0"><strong><small>How do I </small><br>
    </strong></font></p>
    <p><a name="binding"></a><a name="top_bind"></a><font face="Verdana" color="#0080C0"><strong><small>Bind:</small></strong></font><ul>
      <li><a href="#bind_domain"><strong><font face="Verdana" color="#0080C0"><small>Bind to an NT
        4.0 domain</small> <small>directory</small></font></strong></a><font face="Verdana" color="#000000"><br>
        <small>Windows machine may participate in a domain. You must know the domain name to which
        you want to bind.</small></font></li>
    </ul>
    <ul>
      <li><a href="#bind_local"><font face="Verdana" color="#0080C0"><strong><small>Bind to a NT
        4.0 local directory of a machine</small></strong> </font></a><font face="Verdana" color="#000000"><br>
        <small>Each NT workstation and stand alone server has its own directory. You use Mini User
        Manager (or Windows 2000 Local User Manager ) tool to managet it. You must know the
        machine name to which you want to bind. </small><br>
        </font></li>
    </ul>
    <p><a name="top_user"></a><font face="Verdana" color="#0080C0"><strong><small>User:</small><br>
    </strong></font><ul>
      <li><a href="#user_create"><font face="Verdana" color="#0080C0"><strong><small>Create a user</small></strong></font></a></li>
    </ul>
    <ul>
      <li><a href="#user_fullname"><font face="Verdana" color="#0080C0"><strong><small>Change
        user's Full Name and Description</small></strong></font></a></li>
    </ul>
    <ul>
      <li><a href="#user_pwd_change"><strong><font face="Verdana" color="#0080C0"><small>Change
        user's password</small></font></strong></a></li>
    </ul>
    <ul>
      <li><a href="#user_pwd_set"><strong><font face="Verdana" color="#0080C0"><small>Set user's
        password</small></font></strong></a></li>
    </ul>
    <ul>
      <li><a href="#user_pwd_expire"><strong><font face="Verdana" color="#0080C0"><small>Set
        user's password expiration date</small></font></strong></a></li>
    </ul>
    <ul>
      <li><a href="#usr_pwd_nextLogon"><font face="Verdana" color="#0080C0"><strong><small>Make
        user to change password at next logon</small></strong></font></a></li>
    </ul>
    <ul>
      <li><a href="#user_pwd_cant_change"><font face="Verdana" color="#0080C0"><strong><small>Make
        user can't change his/her password</small></strong></font></a></li>
    </ul>
    <ul>
      <li><a href="#user_pwd_never"><font face="Verdana" color="#0080C0"><strong><small>Make
        user's password never expired</small></strong></font></a></li>
    </ul>
    <ul>
      <li><a href="#user_acct_disabled"><font face="Verdana" color="#0080C0"><strong><small>Make
        user's account disabled</small></strong></font></a></li>
    </ul>
    <ul>
      <li><a href="#usr_acct_expire"><font face="Verdana" color="#0080C0"><strong><small>Set
        user's account expiration</small></strong></font></a></li>
    </ul>
    <ul>
      <li><a href="#user_acct_unlock"><strong><font face="Verdana" color="#0080C0"><small>Unlock
        the user's account</small></font></strong></a></li>
    </ul>
    <ul>
      <li><a href="#user_home_dir"><small><font face="Verdana" color="#0080C0"><strong>Set user's
        home directory and home drive directory</strong></font></small></a></li>
    </ul>
    <ul>
      <li><a href="#user_login_script"><font face="Verdana" color="#0080C0"><strong><small>Set
        user's login script</small></strong></font></a></li>
    </ul>
    <ul>
      <li><a href="#usr_primary_group"><font face="Verdana" color="#0080C0"><strong><small>Get
        user's primary group</small></strong></font></a></li>
    </ul>
    <ul>
      <li><a href="#user_sid"><font face="Verdana" color="#0080C0"><strong><small>Get the user's
        SID (Security ID)</small></strong></font></a></li>
    </ul>
    <ul>
      <li><a href="#usr_delete"><strong><font face="Verdana" color="#0080C0"><small>Delete a user</small></font></strong></a></li>
    </ul>
    <ul>
      <li><a href="#user_rename"><strong><font face="Verdana" color="#0080C0"><small>Rename a user</small></font></strong></a></li>
    </ul>
    <p><small><font face="Verdana">Source code can be found in \samples\WinNT\User directory</font></small></p>
    <p><font face="Verdana"><br>
    </font><a name="top_group"></a><font face="Verdana" color="#0080C0"><strong><small>Group:</small></strong></font><ul>
      <li><a href="#group_create"><font color="#0080C0" face="Verdana"><strong><small>Create a
        group</small></strong></font></a></li>
    </ul>
    <ul>
      <li><a href="#group_add_user"><strong><font face="Verdana" color="#0080C0"><small>Add a user
        to a group</small></font></strong></a></li>
    </ul>
    <ul>
      <li><a href="#group_add"><font face="Verdana" color="#0080C0"><strong><small>Add a group to
        a group</small></strong></font></a></li>
    </ul>
    <ul>
      <li><a href="#group_enumerate"><font face="Verdana" color="#0080C0"><strong><small>Enumerate
        group in a domain or computer</small></strong></font></a></li>
    </ul>
    <ul>
      <li><a href="#group_member"><small><font face="Verdana" color="#0080C0"><strong>Enumerate
        group membership</strong></font></small></a></li>
    </ul>
    <ul>
      <li><a href="#group_remove"><font face="Verdana" color="#0080C0"><strong><small>Remove
        member from group</small></strong></font></a></li>
    </ul>
    <ul>
      <li><a href="#group_ismember"><font face="Verdana" color="#0080C0"><strong><small>Find out
        if a user or group is a member of a group</small></strong></font></a></li>
    </ul>
    <p><small><font face="Verdana">Source code can be found in \samples\WinNT\Group directory</font></small></p>
    <p><a name="top_computer"></a><font face="Verdana" color="#0080C0"><strong><small>Computer:</small></strong></font><ul>
      <li><a href="#computer"><font face="Verdana" color="#0080C0"><small><strong>Connect to a
        computer</strong></small></font></a></li>
    </ul>
    <ul>
      <li><a href="#service_enumerate"><font face="Verdana" color="#0080C0"><small><strong>Enumerate
        services in a computer</strong></small></font></a></li>
    </ul>
    <ul>
      <li><a href="#service_display"><font face="Verdana" color="#0080C0"><small><strong>Display
        service's properties</strong></small></font></a></li>
    </ul>
    <ul>
      <li><a href="#service_operations"><font face="Verdana" color="#0080C0"><small><strong>Stop,
        start a service</strong></small></font></a></li>
    </ul>
    <ul>
      <li><a href="#fileshare_enumerate"><font face="Verdana" color="#0080C0"><small><strong>Enumerate
        file shares in a computer</strong></small></font></a></li>
    </ul>
    <ul>
      <li><a href="#fileshare_create"><font face="Verdana" color="#0080C0"><small><strong>Create a
        file share in a computer</strong></small></font></a></li>
    </ul>
    <ul>
      <li><a href="#fileshare_delete"><font face="Verdana" color="#0080C0"><small><strong>Delete a
        file share</strong></small></font></a></li>
    </ul>
    <ul>
      <li><a href="#fileshare_security"><font face="Verdana" color="#0080C0"><small><strong>Set
        File Share security</strong></small></font></a></li>
    </ul>
    <ul>
      <li><a href="#session"><font face="Verdana" color="#0080C0"><small><strong>Enumerate
        sessions in a computer</strong></small></font></a></li>
    </ul>
    <ul>
      <li><a href="#resource"><font face="Verdana" color="#0080C0"><small><strong>Enumerate
        resources in a computer</strong></small></font></a></li>
    </ul>
    <p><small><font face="Verdana">Source code can be found in \samples\WinNT\Computer
    directory</font></small></p>
    <p><a name="top_file"></a><font face="Verdana" color="#0080C0"><strong><small>File</small></strong></font><ul>
      <li><a href="#file"><strong><font face="Verdana" color="#0080C0"><small>Set and get file
        security</small></font></strong></a></li>
    </ul>
    <p>&nbsp;</p>
    <p>&nbsp;</p>
    <p><a name="bind_domain"></a><font face="Verdana" color="#0080C0"><strong><small>Binding
    &nbsp; to an NT 4.0 domain</small> <small>directory</small></strong></font></p>
    <p><font face="Verdana" color="#000000"><small>You must supply the NT 4.0 domain name.
    ADSI will transparently connect to one of the domain controllers.</small></font></p>
    <p><small><font face="Verdana">'-----------------------------------------------------<br>
    '--- BINDING TO A DOMAIN -----------------------------<br>
    '------------------------------------------------------<br>
    domainName = &quot;INDEPENDENCE&quot;<br>
    userName = &quot;Administrator&quot;<br>
    password = &quot;password&quot;<br>
    <br>
    '--- Binding to a domain as currently logged on user<br>
    Set dom = GetObject(&quot;WinNT://&quot; &amp; domainName)<br>
    '- Enumerate object in a domain<br>
    For Each obj In dom<br>
    &nbsp;&nbsp; Debug.Print obj.Name &amp; &quot; (&quot; &amp; obj.Class &amp; &quot;)&quot;<br>
    Next<br>
    <br>
    <br>
    '--- Binding to a domain with alternate credentials<br>
    Set dso = GetObject(&quot;WinNT:&quot;)<br>
    Set dom = dso.OpenDSObject(&quot;WinNT://&quot; &amp; domainName, userName, password,
    ADS_SECURE_AUTHENTICATION)<br>
    <br>
    '--- Enumerate object in a domain<br>
    For Each obj In dom<br>
    &nbsp;&nbsp; Debug.Print obj.Name &amp; &quot; (&quot; &amp; obj.Class &amp; &quot;)&quot;<br>
    Next</font></small></p>
    <p><font face="Verdana"><small>For VB Script click here.</small><br>
    <small>For VC++ Source Code, click here.</small></font></p>
    <p><small><font face="Verdana">Back to <a href="#top_bind">top</a></font></small></p>
    <p><a name="bind_local"></a><small><font face="Verdana" color="#0080C0"><strong>Binding to
    a NT 4.0 local directory on a machine</strong></font><font face="Verdana"><br>
    <br>
    '-----------------------------------------------------<br>
    '--- BINDING TO A COMPUTER ---------------------<br>
    '------------------------------------------------------<br>
    computerName = &quot;ADSI&quot;<br>
    userName = &quot;Administrator&quot;<br>
    password = &quot;password&quot;<br>
    <br>
    <br>
    '--- Binding to a computer as currently logged on user<br>
    Set com = GetObject(&quot;WinNT://&quot; &amp; computerName &amp; &quot;,computer&quot;)<br>
    '- Enumerate object in a computer<br>
    For Each obj In com<br>
    Debug.Print obj.Name &amp; &quot; (&quot; &amp; obj.Class &amp; &quot;)&quot;<br>
    Next<br>
    <br>
    <br>
    '--- Binding to a computer with alternate credentials<br>
    Set dso = GetObject(&quot;WinNT:&quot;)<br>
    Set com = dso.OpenDSObject(&quot;WinNT://&quot; &amp; computerName &amp;
    &quot;,computer&quot;, userName, password, ADS_SECURE_AUTHENTICATION)<br>
    <br>
    '--- Enumerate object in a computer<br>
    For Each obj In com<br>
    &nbsp;&nbsp; Debug.Print obj.Name<br>
    Next<br>
    </font></small></p>
    <p><small><font face="Verdana">Back to <a href="#top_bind">top</a></font></small></p>
    <p><a name="user_create"></a><font face="Verdana" color="#0080C0"><strong><small>Creating
    a user</small></strong></font></p>
    <p><small><font face="Verdana">domainName = &quot;INDEPENDENCE&quot;<br>
    '--- Binding to a domain as currently logged on user<br>
    Set dom = GetObject(&quot;WinNT://&quot; &amp; domainName)<br>
    '--- Create user<br>
    Set usr = dom.Create(&quot;user&quot;, &quot;JSmith&quot;)<br>
    usr.SetInfo</font></small></p>
    <p><small><font face="Verdana">Back to <a href="#top_user">top</a></font></small></p>
    <p><a name="user_fullname"></a><font face="Verdana" color="#0080C0"><strong><small>Changing
    user's Full Name and Description</small></strong></font></p>
    <p><small><font face="Verdana">Set usr =
    GetObject(&quot;WinNT://INDEPENDENCE/jsmith,user&quot;)<br>
    usr.FullName = &quot;John Smith&quot;<br>
    usr.Description = &quot;DSys WOSD Program Manager&quot;<br>
    usr.SetInfo<br>
    </font></small></p>
    <p><small><font face="Verdana">Back to <a href="#top_user">top</a></font></small></p>
    <p><font face="Verdana" color="#0080C0"><strong><small>&nbsp;</small></strong></font></p>
    <p><a name="user_pwd_change"></a><font face="Verdana" color="#0080C0"><strong><small>Changing
    user's password</small></strong></font></p>
    <p><font face="Verdana"><small>A user may change his/her own password, but not others.
    Administrators have privilage to change password any user's password. <strong>ChangePassword</strong>
    requires an old password and the user must already exist in the directory, while <strong>SetPassword</strong>
    does not. Both functions do not require SetInfo to commit the changes.</small></font></p>
    <p><small><font face="Verdana">'---- CHANGE PASSWORD ------</font></small></p>
    <p><font face="Verdana"><small>Set usr =
    GetObject(&quot;WinNT://INDEPENDENCE/jsmith,user&quot;)</small><br>
    <small>usr.ChangePassword &quot;secret&quot;, &quot;password&quot;<br>
    </small></font></p>
    <p><small><font face="Verdana">Back to <a href="#top_user">top</a></font></small></p>
    <p><small><font face="Verdana">&nbsp;</font></small></p>
    <p><a name="user_pwd_set"></a><font face="Verdana" color="#0080C0"><strong><small>Setting
    user's password</small></strong></font><font face="Verdana" color="#000000"><br>
    </font><font face="Verdana"><small>Administrators may reset the user password. </small></font></p>
    <p><font face="Verdana"><small>'---- SET PASSWORD ------ </small></font></p>
    <p><font face="Verdana"><small>Set usr =
    GetObject(&quot;WinNT://INDEPENDENCE/jsmith,user&quot;)</small><br>
    <small>usr.SetPassword &quot;secret&quot;</small></font><br>
    </p>
    <p><small><font face="Verdana">Back to <a href="#top_user">top</a></font></small></p>
    <p><a name="user_pwd_expire"></a><font face="Verdana" color="#0080C0"><strong><small>Setting
    user's password expiration date</small></strong></font><font face="Verdana" color="#000000"><br>
    </font><font face="Verdana" color="#000000" SIZE="2">The password expiration date is a
    calculated field. The value is computed as follows:</font><ul>
      <li><font face="Verdana" color="#000000" SIZE="2">If the user's &quot;Password Never
        Expired&quot; (UF_DONT_EXPIRE_PASSWD) Flag is set, then there's no need to compute. The
        user password is valid.</font></li>
      <li><font face="Verdana" color="#000000" SIZE="2">If this user's flag is not set, then it
        computes the different between password last set and current time. </font></li>
      <li><font face="Verdana" color="#000000" SIZE="2">if the different is greater or equal to
        MaxPasswordAge found in the domain object, then the user's password is expired.</font></li>
      <li><font face="Verdana" color="#000000" SIZE="2">if the different is less than
        MaxPasswordAge, then user's password expiration date = user's password last set +
        MaxPasswordAge.</font></li>
    </ul>
    <p><font face="Verdana" color="#000000" SIZE="2">To get user's password expiration date:</font></p>
    <p><font face="Verdana" color="#000000" SIZE="2">To set user's password expiration date,
    you set this in the domain object. Note this will affect all users since it's the password
    expiration date is a calculated field from the domain object.</font></p>
    <p><small><font face="Verdana">expInDay = 60&amp;<br>
    expInSec = expInDay * (3600&amp; * 24&amp;)<br>
    Set dom = GetObject(&quot;WinNT://INDEPENDENCE&quot;)<br>
    dom.Put &quot;MaxPasswordAge&quot;, CLng(expInSec)<br>
    dom.SetInfo<br>
    </font></small></p>
    <p><small><font face="Verdana">Back to <a href="#top_user">top</a></font></small></p>
    <p><a name="usr_pwd_nextLogon"></a><font face="Verdana" color="#0080C0"><strong><small>Making
    user to change password at next logon</small></strong></font></p>
    <p><font face="Verdana"><small>Set usr =
    GetObject(&quot;WinNT://INDEPENDENCE/jsmith,user&quot;)</small><br>
    <small>usr.Put &quot;PasswordExpired&quot;, CLng(1)<br>
    usr.SetInfo<br>
    <br>
    '-- To clear this flag (making user <u>not</u> to change password at next logon)<br>
    usr.Put &quot;PasswordExpired&quot;, CLng(0)<br>
    usr.SetInfo<br>
    </small></font></p>
    <p><font face="Verdana"><small>Back to <a href="#top_user">top</a></small></font></p>
    <p><a name="user_pwd_cant_change"></a><font face="Verdana" color="#0080C0"><strong><small>Making
    user can't change his/her password</small></strong></font></p>
    <p><small><font face="Verdana">Set usr =
    GetObject(&quot;WinNT://INDEPENDENCE/jsmith,user&quot;)<br>
    usr.Put &quot;userFlags&quot;, usr.Get(&quot;UserFlags&quot;) Or UF_PASSWORD_CANT_CHANGE<br>
    usr.SetInfo<br>
    '-----to clear this flag - use Xor : allow user to change his/her password<br>
    usr.Put &quot;userFlags&quot;, usr.Get(&quot;UserFlags&quot;) Xor UF_PASSWORD_CANT_CHANGE<br>
    usr.SetInfo<br>
    </font></small></p>
    <p><small><font face="Verdana">Back to <a href="#top_user">top</a></font></small></p>
    <p><a name="user_pwd_never"></a><font face="Verdana" color="#0080C0"><strong><small>Making
    user's password never expired</small></strong></font></p>
    <p><small><font face="Verdana">Set usr =
    GetObject(&quot;WinNT://INDEPENDENCE/jsmith,user&quot;)<br>
    usr.Put &quot;userFlags&quot;, usr.Get(&quot;UserFlags&quot;) Or UF_DONT_EXPIRE_PASSWD<br>
    usr.SetInfo<br>
    '---- To clear this flag - use XOr<br>
    usr.Put &quot;userFlags&quot;, usr.Get(&quot;UserFlags&quot;) Xor UF_DONT_EXPIRE_PASSWD<br>
    usr.SetInfo<br>
    </font></small></p>
    <p><small><font face="Verdana">Back to <a href="#top_user">top</a></font></small></p>
    <p><a name="user_acct_disabled"></a><font face="Verdana" color="#0080C0"><strong><small>Making
    user's account disabled</small></strong></font></p>
    <p><font face="Verdana"><small>Set usr =
    GetObject(&quot;WinNT://INDEPENDENCE/jsmith,user&quot;)</small><br>
    <small>usr.AccountDisabled = True 'disabled the account<br>
    usr.SetInfo<br>
    '---- To enabled an acount<br>
    usr.AccountDisabled = False 'enabled the account<br>
    usr.SetInfo</small></font></p>
    <p><small><font face="Verdana">Back to <a href="#top_user">top</a></font></small></p>
    <p><a name="usr_acct_expire"></a><font face="Verdana" color="#0080C0"><strong><small>Setting
    user's account expiration</small></strong></font></p>
    <p><small><font face="Verdana">Set usr =
    GetObject(&quot;WinNT://INDEPENDENCE/jsmith,user&quot;)</font></small></p>
    <p><font face="Verdana"><small>'--Set a user account expiration 90 days from now</small><br>
    <small>usr.AccountExpirationDate = Now() + 90<br>
    usr.SetInfo<br>
    '-- to set account expiration to <u>NEVER</u> (default)<br>
    usr.AccountExpirationDate = &quot;01/01/1970&quot;<br>
    usr.SetInfo<br>
    </small></font></p>
    <p><font face="Verdana"><small>Back to <a href="#top_user">top</a></small></font></p>
    <p><a name="user_acct_unlock"></a><font face="Verdana" color="#0080C0"><strong><small>Unlocking
    the user's account</small></strong></font><br>
    <font face="Verdana"><small>You can only set the account lockout to FALSE. Only the system
    can set the account lockout. You can also read the value of account lockout, but you can't
    lock the user's account.<br>
    </small></font></p>
    <p><font face="Verdana"><small>'--- Unlocking user's account ------------------</small></font></p>
    <p><font face="Verdana"><small>Set usr = GetObject(&quot;WinNT://INDEPENDENCE/jsmith,user)</small><br>
    <small>usr.IsAccountLocked = False<br>
    usr.SetInfo</small></font></p>
    <p><small><font face="Verdana">Back to <a href="#top_user">top</a></font></small></p>
    <p><a name="user_home_dir"></a><font face="Verdana" color="#0080C0"><strong><small>Setting
    user's home directory and home drive directory</small></strong></font></p>
    <p><a name="usr_primary_group"></a><small><font face="Verdana">Set usr =
    GetObject(&quot;WinNT://INDEPENDENCE/jsmith,user&quot;)<br>
    usr.HomeDirectory = &quot;UserHomeDirHere&quot;<br>
    usr.HomeDirDrive = &quot;HomeDirDriveHere&quot;<br>
    usr.SetInfo</font></small></p>
    <p><small><font face="Verdana">Back to <a href="#top_user">top</a></font></small></p>
    <p><a name="user_login_script"></a><font face="Verdana" color="#0080C0"><strong><small>Set
    user's login script</small></strong></font></p>
    <p><small><font face="Verdana">Set usr =
    GetObject(&quot;WinNT://INDEPENDENCE/jsmith,user&quot;)<br>
    usr.LoginScript = &quot;LoginScriptHere&quot;<br>
    usr.SetInfo<br>
    </font></small></p>
    <p><small><font face="Verdana">Back to <a href="#top_user">top</a></font></small></p>
    <p><a name="user_primary_group"></a><font face="Verdana" color="#0080C0"><strong><small>Getting
    user's primary group</small></strong></font></p>
    <p><small><font face="Verdana">Set usr =
    GetObject(&quot;WinNT://INDEPENDENCE/jsmith,user&quot;)<br>
    grpPrimaryID = usr.Get(&quot;PrimaryGroupID&quot;)</font></small></p>
    <p><small><font face="Verdana">Back to <a href="#top_user">top</a></font></small></p>
    <p><a name="user_sid"></a><font face="Verdana" color="#0080C0"><strong><small>Getting the
    user's SID (Security ID)</small></strong></font></p>
    <p><a name="user_login"></a><small><font face="Verdana">Set usr =
    GetObject(&quot;WinNT://INDEPENDENCE/jsmith,user&quot;)<br>
    sid = usr.Get(&quot;objectSID&quot;)<br>
    For Each element In sid<br>
    &nbsp;&nbsp; Debug.Print Hex(element)<br>
    Next</font></small></p>
    <p><small><font face="Verdana">Back to <a href="#top_user">top</a></font></small></p>
    <p><a name="user_rename"></a><font face="Verdana" color="#0080C0"><strong><small>Renaming
    a user</small></strong></font></p>
    <p><font face="Verdana" color="#000000"><small>Renaming a user is similar to <a href="start.htm#rename">renaming an object</a>.</small></font></p>
    <p><small><font face="Verdana">Set dom = GetObject(&quot;WinNT://INDEPENDENCE&quot;)<br>
    Set usr = dom.MoveHere(&quot;WinNT://INDEPENDENCE/jsmith,user&quot;, &quot;jjohnson&quot;)<br>
    usr.FullName = &quot;Jane Johnson&quot;<br>
    usr.SetInfo</font></small></p>
    <p><small><font face="Verdana">Back to <a href="#top_user">top</a></font></small></p>
    <p><a name="usr_delete"></a><font face="Verdana" color="#0080C0"><strong><small>Deleting a
    user</small></strong></font></p>
    <p><font face="Verdana" color="#000000"><small>Deleting a user is similar to <a href="start.htm#delete">deleting an object</a></small></font></p>
    <p><small><font face="Verdana">Set dom = GetObject(&quot;WinNT://INDEPENDENCE&quot;)<br>
    dom.Delete &quot;user&quot;, &quot;jjohnson&quot;</font></small></p>
    <p><small><font face="Verdana">Back to <a href="#top_user">top</a></font></small></p>
    <p><a name="group_create"></a><font face="Verdana" color="#0080C0"><strong><small>Creating
    a group</small></strong></font><font face="Verdana" color="#000000"><br>
    </font></p>
    <p><small><font face="Verdana">'-----------------------------------------<br>
    '--- CREATING A LOCAL GROUP IN A DOMAIN<br>
    '-----------------------------------------<br>
    Set dom = GetObject(&quot;WinNT://INDEPENDENCE&quot;)<br>
    Set grp = dom.Create(&quot;group&quot;, &quot;DSys&quot;)<br>
    grp.Put &quot;groupType&quot;, ADS_GROUP_TYPE_DOMAIN_LOCAL_GROUP<br>
    grp.Description = &quot;Distributed System Group&quot;<br>
    grp.SetInfo<br>
    <br>
    '-----------------------------------------<br>
    '--- CREATING A GLOBAL GROUP IN A DOMAIN<br>
    '-----------------------------------------<br>
    Set dom = GetObject(&quot;WinNT://INDEPENDENCE&quot;)<br>
    Set grp = dom.Create(&quot;group&quot;, &quot;PM&quot;)<br>
    grp.Put &quot;groupType&quot;, ADS_GROUP_TYPE_GLOBAL_GROUP<br>
    grp.Description = &quot;Program Managers&quot;<br>
    grp.SetInfo<br>
    <br>
    <br>
    '-----------------------------------------<br>
    '--- CREATING A LOCAL GROUP IN A COMPUTER<br>
    '-----------------------------------------<br>
    Set comp = GetObject(&quot;WinNT://SEATTLE,computer&quot;)<br>
    Set grp = comp.Create(&quot;group&quot;, &quot;TheSmiths&quot;)<br>
    grp.Put &quot;groupType&quot;, ADS_GROUP_TYPE_LOCAL_GROUP<br>
    grp.Description = &quot;The Smiths Family Member&quot;<br>
    grp.SetInfo<br>
    </font></small></p>
    <p><small><font face="Verdana">Back to <a href="#top_group">top</a></font></small></p>
    <p><small><font face="Verdana"><br>
    </font></small></p>
    <p><a name="group_add_user"></a><font face="Verdana" color="#0080C0"><strong><small>Adding
    a user to a group</small></strong></font></p>
    <p><small><font face="Verdana">'----------------------------------------------------<br>
    '--- ADDING A USER IN A DOMAIN LOCAL or GLOBAL GROUP<br>
    '----------------------------------------------------<br>
    Set grp = GetObject(&quot;WinNT://INDEPENDENCE/DSys,group&quot;)<br>
    grp.Add (&quot;WinNT://INDEPENDENCE/JSmith&quot;)<br>
    <br>
    <br>
    '-------------------------------------------------<br>
    '--- ADDING A USER IN A LOCAL GROUP IN A COMPUTER<br>
    '--------------------------------------------------<br>
    Set comp = GetObject(&quot;WinNT://SEATTLE,computer&quot;)<br>
    Set grp = comp.GetObject(&quot;group&quot;, &quot;TheSmiths&quot;)<br>
    grp.Add (&quot;WinNT://INDEPENDENCE/JSmith&quot;)<br>
    </font></small></p>
    <p><small><font face="Verdana">Back to <a href="#top_group">top</a></font></small></p>
    <p><a name="group_add"></a><small><font face="Verdana" color="#0080C0"><strong>Adding a
    group to a group<br>
    </strong></font><font face="Verdana">Global group can be added to a local group in a NT
    4.0 domain. Note in Windows 2000 domain enviroment you can nest group.</font></small></p>
    <p><small><font face="Verdana">Set grp =
    GetObject(&quot;WinNT://INDEPENDENCE/DSys,group&quot;)<br>
    grp.Add (&quot;WinNT://INDEPENDENCE/PM,group&quot;)<br>
    </font></small></p>
    <p><small><font face="Verdana">Back to <a href="#top_group">top</a></font></small></p>
    <p><a name="group_enumerate"></a><font face="Verdana" color="#0080C0"><strong><small>Enumerating
    group in a domain or computer</small></strong></font></p>
    <p><font face="Verdana"><small>'--------------------------------------------------<br>
    ' ENUMERATING GROUPS IN A DOMAIN<br>
    '-------------------------------------------------<br>
    Set dom = GetObject(&quot;WinNT://INDEPENDENCE&quot;)<br>
    dom.Filter = Array(&quot;Group&quot;)<br>
    <br>
    '--- Local Group<br>
    Debug.Print &quot;Local Groups---&quot;<br>
    For Each grp In dom<br>
    If (grp.GroupType = ADS_GROUP_TYPE_DOMAIN_LOCAL_GROUP) Then<br>
    &nbsp;&nbsp; Debug.Print grp.Name<br>
    End If<br>
    Next<br>
    <br>
    '-- Global Group<br>
    Debug.Print &quot;Global Groups---&quot;<br>
    For Each grp In dom<br>
    If (grp.GroupType = ADS_GROUP_TYPE_GLOBAL_GROUP) Then<br>
    &nbsp;&nbsp;&nbsp; Debug.Print grp.Name<br>
    End If<br>
    Next<br>
    <br>
    '--------------------------------------------------<br>
    ' ENUMERATING GROUPS IN A COMPUTER<br>
    '-------------------------------------------------<br>
    Set comp = GetObject(&quot;WinNT://SEATTLE,computer&quot;)<br>
    comp.Filter = Array(&quot;Group&quot;)<br>
    <br>
    'All groups in a computer is a local group<br>
    Debug.Print &quot;Groups:&quot;<br>
    For Each grp In comp<br>
    &nbsp;&nbsp; Debug.Print grp.Name<br>
    Next<br>
    </small></font></p>
    <p><small><font face="Verdana">Back to <a href="#top_group">top</a></font></small></p>
    <p><a name="group_member"></a><font face="Verdana" color="#0080C0"><small><strong>Enumerating
    group membership</strong></small></font></p>
    <p><font face="Verdana"><small>'--------------------------------------------------<br>
    ' ENUMERATING GROUPS MEMBERSHIP<br>
    '-------------------------------------------------<br>
    Set grp = GetObject(&quot;WinNT://INDEPENDENCE/DSys,group&quot;)<br>
    For Each member In grp.Members<br>
    &nbsp;&nbsp;&nbsp;&nbsp; Debug.Print member.Name &amp; &quot; (&quot; &amp; member.Class
    &amp; &quot;)&quot;</small><br>
    <small><br>
    &nbsp;&nbsp;&nbsp;&nbsp; 'A local group may contain a global group<br>
    &nbsp;&nbsp;&nbsp;&nbsp; 'We can enumerate the global group membership as well<br>
    &nbsp;&nbsp;&nbsp;&nbsp; If (member.Class = &quot;Group&quot;) Then<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For Each obj In
    member.Members<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    Debug.Print &quot; &quot; &amp; obj.Name &amp; &quot; (&quot; &amp; obj.Class &amp;
    &quot;)&quot;<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Next<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If</small><br>
    <small><br>
    Next</small></font></p>
    <p><small><font face="Verdana">Back to <a href="#top_group">top</a></font></small></p>
    <p><a name="group_remove"></a><font face="Verdana" color="#0080C0"><strong><small>Removing
    member from group</small></strong></font></p>
    <p><small><font face="Verdana">'-----------------------------------------------------<br>
    ' REMOVING MEMBER FROM A GROUP<br>
    '-----------------------------------------------------<br>
    Set grp = GetObject(&quot;WinNT://INDEPENDENCE/PM,group&quot;)<br>
    grp.Remove (&quot;WinNT://INDEPENDENCE/ChristyH&quot;)<br>
    </font></small></p>
    <p><small><font face="Verdana">Back to <a href="#top_group">top</a></font></small></p>
    <p><a name="group_ismember"></a><font face="Verdana" color="#0080C0"><strong><small>Finding
    out if a user or group is a member of a group</small></strong></font></p>
    <p><small><font face="Verdana">'---------------------------------------------------<br>
    ' IS MEMBER<br>
    '---------------------------------------------------<br>
    Set grp = GetObject(&quot;WinNT://INDEPENDENCE/DSys,group&quot;)<br>
    If (grp.IsMember(&quot;WinNT://INDEPENDENCE/JSmith&quot;)) Then<br>
    &nbsp;&nbsp; Debug.Print &quot;Yes&quot;<br>
    Else<br>
    &nbsp;&nbsp; Debug.Print &quot;No&quot;<br>
    End If<br>
    </font></small></p>
    <p><small><font face="Verdana">Back to <a href="#top_group">top</a></font></small></p>
    <p><a name="computer"></a><font face="Verdana" color="#0080C0"><small><strong>Connecting
    to a computer</strong></small></font></p>
    <p><small><font face="Verdana">'-----------------------------------------<br>
    '--- BINDING TO COMPUTER OBJECT<br>
    '-----------------------------------------<br>
    Set comp = GetObject(&quot;WinNT://INDEPENDENCE/SEATTLE,computer&quot;)<br>
    Debug.Print comp.Division<br>
    Debug.Print comp.OperatingSystem<br>
    Debug.Print comp.OperatingSystemVersion<br>
    Debug.Print comp.Owner<br>
    Debug.Print comp.Processor<br>
    Debug.Print comp.ProcessorCount<br>
    </font></small></p>
    <p><small><font face="Verdana">Back to <a href="#top_computer">top</a></font></small></p>
    <p><a name="service_enumerate"></a><font face="Verdana" color="#0080C0"><small><strong>Enumerating
    services in a computer</strong></small></font></p>
    <p><small><font face="Verdana">'-------------------------------------------<br>
    '--- ENUMERATE SERVICES IN A COMPUTER<br>
    '-------------------------------------------<br>
    Set comp = GetObject(&quot;WinNT://INDEPENDENCE/SEATTLE,computer&quot;)<br>
    comp.Filter = Array(&quot;Service&quot;)<br>
    <br>
    For Each svc In comp<br>
    &nbsp;&nbsp;&nbsp; Debug.Print svc.Name &amp; &quot; &quot; &amp; svc.DisplayName<br>
    Next</font></small></p>
    <p><small><font face="Verdana">Back to <a href="#top_computer">top</a></font></small></p>
    <p><a name="service_display"></a><strong><font face="Verdana" color="#0080C0"><small>Displaying
    service's properties</small></font></strong></p>
    <p><font face="Verdana"><small>'----------------------------------------------<br>
    '--- DISPLAY SERVICE'S PROPERTIES<br>
    '-----------------------------------------------</small></font></p>
    <p><font face="Verdana"><small>'--- Defined in winnt.h ----------------<br>
    <br>
    Const SERVICE_BOOT_START = &amp;H0<br>
    Const SERVICE_SYSTEM_START = &amp;H1<br>
    Const SERVICE_AUTO_START = &amp;H2<br>
    Const SERVICE_DEMAND_START = &amp;H3<br>
    Const SERVICE_DISABLED = &amp;H4<br>
    '<br>
    ' Error control type<br>
    '<br>
    Const SERVICE_ERROR_IGNORE = &amp;H0<br>
    Const SERVICE_ERROR_NORMAL = &amp;H1<br>
    Const SERVICE_ERROR_SEVERE = &amp;H2<br>
    Const SERVICE_ERROR_CRITICAL = &amp;H3<br>
    <br>
    Const SERVICE_KERNEL_DRIVER = &amp;H1<br>
    Const SERVICE_FILE_SYSTEM_DRIVER = &amp;H2<br>
    Const SERVICE_ADAPTER = &amp;H4<br>
    Const SERVICE_RECOGNIZER_DRIVER = &amp;H8<br>
    <br>
    Const SERVICE_DRIVER = &amp;HB<br>
    Const SERVICE_WIN32_OWN_PROCESS = &amp;H10<br>
    Const SERVICE_WIN32_SHARE_PROCESS = &amp;H20<br>
    Const SERVICE_WIN32 = &amp;H30<br>
    Const SERVICE_INTERACTIVE_PROCESS = &amp;H100<br>
    <br>
    <br>
    Set comp = GetObject(&quot;WinNT://SEATTLE,computer&quot;)<br>
    Set svc = comp.GetObject(&quot;Service&quot;, &quot;Browser&quot;)</small><br>
    <small><br>
    Debug.Print &quot;Display Name: &quot; &amp; svc.DisplayName<br>
    Debug.Print &quot;Order Group: &quot; &amp; svc.LoadOrderGroup<br>
    Debug.Print &quot;Host Name: &quot; &amp; svc.HostComputer<br>
    <br>
    s = &quot;Startup: &quot;<br>
    <br>
    Select Case svc.StartType<br>
    Case SERVICE_BOOT_START<br>
    &nbsp;&nbsp; s = s + &quot;Boot Start&quot;<br>
    Case SERVICE_SYSTEM_START<br>
    &nbsp;&nbsp; s = s + &quot;System Start&quot;<br>
    Case SERVICE_AUTO_START<br>
    &nbsp;&nbsp; s = s + &quot;Automatic&quot;<br>
    Case SERVICE_DEMAND_START<br>
    &nbsp;&nbsp; s = s + &quot;Manual&quot;<br>
    Case SERVICE_DISABLED<br>
    &nbsp;&nbsp; s = s + &quot;Disabled&quot;<br>
    Case Else<br>
    &nbsp;&nbsp; s = s + &quot;Unknown&quot;<br>
    End Select<br>
    Debug.Print s<br>
    <br>
    'Dependencies<br>
    Debug.Print &quot;Dependencies: &quot;<br>
    For Each dpc In svc.Dependencies<br>
    &nbsp;&nbsp;&nbsp; Debug.Print &quot; &quot; &amp; dpc<br>
    Next<br>
    <br>
    'Service Type<br>
    s = &quot;Service Type: &quot;</small><br>
    <small><br>
    Select Case svc.ServiceType<br>
    Case SERVICE_KERNEL_DRIVER<br>
    &nbsp;&nbsp; s = s + &quot;Kernel Driver&quot;<br>
    Case SERVICE_FILE_SYSTEM_DRIVER<br>
    &nbsp;&nbsp; s = s + &quot;File System Driver&quot;<br>
    Case SERVICE_ADAPTER<br>
    &nbsp;&nbsp; s = s + &quot;Adapter&quot;<br>
    Case SERVICE_RECOGNIZER_DRIVER<br>
    &nbsp;&nbsp; s = s + &quot;Recognizer Driver&quot;<br>
    Case SERVICE_WIN32_OWN_PROCESS<br>
    &nbsp;&nbsp; s = s + &quot;Win32 Process&quot;<br>
    Case SERVICE_WIN32_SHARE_PROCESS<br>
    &nbsp;&nbsp; s = s + &quot;Win32 Share Process&quot;<br>
    Case SERVICE_WIN32<br>
    &nbsp;&nbsp; s = s + &quot;Win32&quot;<br>
    Case SERVICE_INTERACTIVE_PROCESS<br>
    &nbsp;&nbsp; s = s + &quot;Interactive Process&quot;<br>
    End Select<br>
    Debug.Print s<br>
    <br>
    'Error Control<br>
    s = &quot;Error Control: &quot;<br>
    Select Case svc.ErrorControl<br>
    <br>
    Case SERVICE_ERROR_IGNORE<br>
    &nbsp;&nbsp; s = s + &quot;Service ignores error&quot;<br>
    Case SERVICE_ERROR_NORMAL<br>
    &nbsp;&nbsp; s = s + &quot;No Error&quot;<br>
    Case SERVICE_ERROR_SEVERE<br>
    &nbsp;&nbsp; s = s + &quot;Severe error&quot;<br>
    Case SERVICE_ERROR_CRITICAL<br>
    &nbsp;&nbsp; s = s + &quot;Critical error&quot;<br>
    Case Else<br>
    &nbsp;&nbsp; s = s + &quot;Unknown&quot;<br>
    End Select<br>
    Debug.Print s</small></font></p>
    <p><font face="Verdana"><small><br>
    Back to <a href="#top_computer">top</a></small></font></p>
    <p><a name="service_operations"></a><font face="Verdana" color="#0080C0"><small><strong>Stoping,
    starting and pausing a service</strong></small></font></p>
    <p><small><font face="Verdana">'----------------------------------------------<br>
    '--- STOPPING, STARTING AND PAUSING A SERVICE<br>
    '-----------------------------------------------<br>
    Set comp = GetObject(&quot;WinNT://SEATTLE,computer&quot;)<br>
    Set svcOp = comp.GetObject(&quot;Service&quot;, &quot;Browser&quot;)<br>
    'Stopping<br>
    svcOp.Stop<br>
    'Starting<br>
    svcOp.Start<br>
    'Pausing<br>
    svcOp.Pause<br>
    </font><font face="Verdana" color="#0080C0"><strong></strong></font></small></p>
    <p><small><font face="Verdana">Back to <a href="#top_computer">top</a></font></small></p>
    <p><a name="fileshare_enumerate"></a><font face="Verdana" color="#0080C0"><small><strong>Enumerating
    file shares in a computer</strong></small></font></p>
    <p><small><font face="Verdana">'------------------------------------------<br>
    '---- ENUMERATING FILE SHARES IN A COMPUTER<br>
    '-------------------------------------------<br>
    Set comp = GetObject(&quot;WinNT://SEATTLE,computer&quot;)<br>
    Set svc = GetObject(comp.ADsPath &amp; &quot;/&quot; &amp; &quot;LanmanServer&quot;)<br>
    For Each fileShare In svc<br>
    &nbsp;&nbsp; Debug.Print fileShare.Name &amp; &quot; &quot; &amp; &quot; &quot; &amp;
    fileShare.CurrentUserCount &amp; &quot; &quot; &amp; fileShare.Path<br>
    Next</font></small></p>
    <p><small><font face="Verdana">Back to <a href="#top_computer">top</a></font></small></p>
    <p><a name="fileshare_create"></a><font face="Verdana" color="#0080C0"><small><strong>Creating
    a file share in a computer</strong></small></font></p>
    <p><small><font face="Verdana">'------------------------------------------<br>
    '---- CREATING A FILE SHARE IN A COMPUTER<br>
    '-------------------------------------------<br>
    Set comp = GetObject(&quot;WinNT://SEATTLE,computer&quot;)<br>
    Set svc = GetObject(comp.ADsPath &amp; &quot;/&quot; &amp; &quot;LanmanServer&quot;)<br>
    Set fileShare = svc.Create(&quot;FileShare&quot;, &quot;public&quot;)<br>
    fileShare.Path = &quot;c:\public&quot;<br>
    fileShare.SetInfo<br>
    </font></small></p>
    <p><small><font face="Verdana">Back to <a href="#top_computer">top</a></font></small></p>
    <p><a name="fileshare_delete"></a><font face="Verdana" color="#0080C0"><small><strong>Delete
    a file share</strong></small></font></p>
    <p><small><font face="Verdana">'------------------------------------------<br>
    '---- DELETING A FILE SHARE IN A COMPUTER<br>
    '-------------------------------------------<br>
    Set comp = GetObject(&quot;WinNT://SEATTLE,computer&quot;)<br>
    Set svc = GetObject(comp.ADsPath &amp; &quot;/&quot; &amp; &quot;LanmanServer&quot;)<br>
    svc.Delete &quot;FileShare&quot;, &quot;public&quot;</font></small></p>
    <p><small><font face="Verdana">Back to <a href="#top_computer">top</a></font></small></p>
    <p><a name="session"></a><font face="Verdana" color="#0080C0"><small><strong>Enumerating
    sessions in a computer</strong></small></font></p>
    <p><font face="Verdana"><small>'--------------------------------------------<br>
    '---- ENUMERATING SESSIONS IN A COMPUTER<br>
    '---------------------------------------------</small></font></p>
    <p><small><font face="Verdana">Dim fileSvc As IADsFileService<br>
    Dim session As IADsSession</font></small><br>
    <small><font face="Verdana"><br>
    Set comp = GetObject(&quot;WinNT://SEATTLE,computer&quot;)<br>
    Set fileSvc = GetObject(comp.ADsPath &amp; &quot;/&quot; &amp; &quot;LanmanServer&quot;)<br>
    For Each session In fileSvc.Sessions<br>
    &nbsp;&nbsp;&nbsp;&nbsp; Debug.Print session.Name &amp; &quot; &quot; &amp;
    session.ConnectTime<br>
    Next</font></small></p>
    <p><small><font face="Verdana">Back to <a href="#top_computer">top</a></font></small></p>
    <p><a name="resource"></a><font face="Verdana" color="#0080C0"><small><strong>Enumerating
    resources in a computer</strong></small></font></p>
    <p><small><font face="Verdana">'--------------------------------------------<br>
    '---- ENUMERATING RESOURCES IN A COMPUTER<br>
    '---------------------------------------------<br>
    Set comp = GetObject(&quot;WinNT://SEATTLE,computer&quot;)<br>
    Set fileSvc = GetObject(comp.ADsPath &amp; &quot;/&quot; &amp; &quot;LanmanServer&quot;)<br>
    For Each resource In fileSvc.Resources<br>
    &nbsp;&nbsp;&nbsp; Debug.Print resource.Name &amp; &quot; - &quot; &amp; resource.User<br>
    Next<br>
    </font><font face="Verdana" color="#0080C0"><strong></strong></font></small></p>
    <p><small><font face="Verdana">Back to <a href="#top_computer">top</a></font></small></p>
    <p><a name="fileshare_security"></a><font face="Verdana" color="#0080C0"><small><strong>Setting
    File Share security</strong></small></font></p>
    <p><font face="Verdana" color="#000000"><small>Setting a file share security is supported
    in the <a href="rtk.htm">ADSI Resource Tool Kit</a>.</small></font></p>
    <p><small><font face="Verdana">Back to <a href="#top_computer">top</a></font></small></p>
    <p><a name="file"></a><font face="Verdana" color="#0080C0"><small><strong>Setting File
    security</strong></small></font></p>
    <p><font face="Verdana" color="#000000"><small>Setting a file security is supported in the
    <a href="rtk.htm">ADSI Resource Tool Kit</a>.</small></font></p>
    <p><small><font face="Verdana">Back to <a href="#top_file">top</a></font></small></td>
  </tr>
</table>
</body>
</html>

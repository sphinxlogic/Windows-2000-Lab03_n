<HTML>
<HEAD>
<TITLE>Protecting COM calls with Permissions</TITLE>
</HEAD>

<BODY BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#0000FF" VLINK="#0000FF" ALINK="#0000FF" TOPMARGIN=0 LEFTMARGIN=0 >

<FONT FACE="VERDANA, GEORGIA, ARIAL, HELVETICA" SIZE="2">

<A NAME="pagetop"></A>

<!--margin-->
<TD WIDTH=23><IMG SRC="/art/1pixel.gif" WIDTH=23 HEIGHT=1></TD>
<!--margin ENDS-->

<!--main title (fixed coloured cell type)-->
<BR>
<TABLE BORDER=0 WIDTH=100%>
<TR><TD BGCOLOR=BLUE WIDTH=200><FONT FACE="HELVETICA, ARIAL" SIZE=4 COLOR=WHITE>
&nbsp;<NOBR>Permissions protecting COM calls</NOBR></FONT>
</TD>
<!--main title ENDS-->

<!--main page navigation-->
<TD WIDTH=50 ALIGN=CENTER VALIGN=TOP></TD>

<TD WIDTH=50 ALIGN=CENTER VALIGN=TOP><FONT FACE="ARIAL,HELVETICA" SIZE=1 COLOR=BLACK>
<A HREF="../custom/sample.html"><IMG SRC="../../art/butt_pre.gif" WIDTH="40" HEIGHT="11"  BORDER=0 ALT="Previous"></A><BR><B>
Previous</B></FONT></TD>

<TD WIDTH=50 ALIGN=CENTER VALIGN=TOP><FONT FACE="ARIAL,HELVETICA" SIZE=1 COLOR=BLACK>
<A HREF="../../art/start.htm"><IMG SRC="../../art/butt_.gif" WIDTH="40" HEIGHT="11"  BORDER=0 ALT="Welcome"></A><BR><B>
Welcome</B></FONT></TD>

<TD WIDTH=50 ALIGN=CENTER VALIGN=TOP><FONT FACE="ARIAL,HELVETICA" SIZE=1 COLOR=BLACK>
<A HREF="../rni/sample.html"><IMG SRC="../../art/butt_nex.gif" WIDTH="40" HEIGHT="11"  BORDER=0 ALT="Next"></A><BR><B>
Next</B></FONT></TD>
</TABLE>
<!--main page navigation ENDS-->


<!--this odd little break must accompany .gif filled cell title-->
<BR>

<font size="2" face="VERDANA, GEORGIA, ARIAL, HELVETICA">

This sample must be run from a command prompt.

<p>

To build debug versions of the classes and c++-implemented COM component:
<pre>
nmake
</pre>
release versions:
<pre>
nmake BUILD=retail
</pre>
Prebuilt binaries are in the 'sample' directory.  Substitute 'debug' or
'retail' for 'sample' in the below instructions to run the versions you
have built.

<p>

Both c++- and java-implemented components must be registered.  Run 'reg.bat',
which does the following:
<pre>
regsvr32 /s sample\comsamp.dll
javareg /register /class:comsamp.CMyCOMObjectSecurity /classid:{8EACC4B4-289A-11d1-BA1D-006008039BF0} /nomktyplib /q
</pre>

<ul>
<li>To run as an application (all checks succeed):
<pre>
jview -cp:p sample;sample\demo demo.Main
</pre>
<li>To run as an applet on the classpath (checks from 'start' fail if file is not relative to docbase):
<pre>
jview -cp:p sample;sample\demo -a demo.Main
</pre>
<li>To run as an applet with sandbox permissions (all checks fail if file is not relative to codebase):
<pre>
jview -cp:p sample -a codebase=sample\demo demo.Main
</pre>
</ul>

</font>


<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0>
        <TR VALIGN=TOP>


<!--main page sub-title-->


<!--rule tex back type>
<TABLE WIDTH=95%><TD HEIGHT=1 BACKGROUND="../../art/Stex_4.gif" BGCOLOR="WHITE"></TD></TABLE>
<BR-->


<TR><TD>
<FONT FACE="VERDANA, GEORGIA, ARIAL, HELVETICA" SIZE=4>
<B></A></B></FONT><BR>

<FONT FACE="HELVETICA, ARIAL" SIZE=2>
<B></B><BR>

<!--remarks 1-->
<FONT FACE="VERDANA, GEORGIA, ARIAL, HELVETICA" SIZE=2>
<B><I>Remarks:</I></B>
<BR>
<I>This sample requires Internet Explorer 4.0</I>

<BR>

<!--rule-->
<TABLE WIDTH=95%><TD HEIGHT=2 BGCOLOR=BLUE></TD></TABLE>
<BR>

<!--page top button-->
<TABLE WIDTH=100%><TR><TD ALIGN=LEFT><A HREF="#pagetop"><IMG SRC="../../art/butt_up.gif" WIDTH="40" HEIGHT="11"  BORDER=0 ALT="Top"></A></TD>

<!--MS copyright-->
<TD ALIGN=RIGHT><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK"><A HREF="../../art/cpyright.htm">&#169; 1996-1997 Microsoft Corporation. All rights reserved.</A></FONT></TD></TR></TABLE>
</FONT>
</BODY>
</HTML>


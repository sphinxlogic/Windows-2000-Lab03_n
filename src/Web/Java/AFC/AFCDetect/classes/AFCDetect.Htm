<HTML>
<HEAD>
<TITLE>AFC Detect Sample</TITLE>
</HEAD>

<BODY BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#0000FF" VLINK="#0000FF" ALINK="#0000FF" TOPMARGIN=0 LEFTMARGIN=0>

<FONT FACE="VERDANA, GEORGIA, ARIAL, HELVETICA" SIZE="2">

<A NAME="pagetop"></A>


<!--margin-->
<TD WIDTH=23><IMG SRC="/art/1pixel.gif" WIDTH=23 HEIGHT=1></TD>
<!--margin ENDS-->



<!--main title (fixed coloured cell type)-->
<BR>
<TABLE BORDER=0 WIDTH=100%>
<TR><TD BGCOLOR=BLUE WIDTH=200><FONT FACE="HELVETICA, ARIAL" SIZE=4 COLOR=WHITE>
&nbsp;
AFC</FONT>
</TD>
<!--main title ENDS-->



<!--main title (fixed textured cell type)>
<BR>
<TABLE BORDER=0 WIDTH=100%>
<TR><TD BACKGROUND="../../art/Stex_4.gif" WIDTH=200>
<FONT FACE="HELVETICA, ARIAL" SIZE=4 COLOR=WHITE>&nbsp;
Sample One</FONT>
</TD>
<main title ENDS-->


<!--main page navigation-->
<TD WIDTH=50 ALIGN=CENTER VALIGN=TOP></TD>

<TD WIDTH=50 ALIGN=CENTER VALIGN=TOP><FONT FACE="ARIAL,HELVETICA" SIZE=1 COLOR=BLACK>
<A HREF="../bandbox/sample.html"><IMG SRC="../../art/butt_pre.gif" WIDTH="40" HEIGHT="11"  BORDER=0 ALT="Previous"></A><BR><B>
Previous</B></FONT></TD>

<TD WIDTH=50 ALIGN=CENTER VALIGN=TOP><FONT FACE="ARIAL,HELVETICA" SIZE=1 COLOR=BLACK>
<A HREF="../../art/start.htm"><IMG SRC="../../art/butt_.gif" WIDTH="40" HEIGHT="11"  BORDER=0 ALT="Welcome"></A><BR><B>
Welcome</B></FONT></TD>

<TD WIDTH=50 ALIGN=CENTER VALIGN=TOP><FONT FACE="ARIAL,HELVETICA" SIZE=1 COLOR=BLACK>
<A HREF="../JDocView/sample.html"><IMG SRC="../../art/butt_nex.gif" WIDTH="40" HEIGHT="11"  BORDER=0 ALT="Next"></A><BR><B>
Next</B></FONT></TD>
</TABLE>
<!--main page navigation ENDS-->


<!--this odd little break must accompany .gif filled cell title-->
<BR>


<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0>
	<TR VALIGN=TOP>


<!--main page sub-title-->
<TD><FONT FACE="VERDANA, GEORGIA, ARIAL, HELVETICA" SIZE=4>
<B>AFC Detect Sample</B></A>
</FONT><BR>

<!--main contents (NEW TABLE required in this scenario)-->
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP>

<FONT FACE="VERDANA, GEORGIA, ARIAL, HELVETICA" SIZE=2>
<P>AFC Detect provides an easy way for developers to determine whether
a AFC is installed on a user's computer. Using this applet and a small amount
of JavaScript on a web page, AFC's presence on a machine can be detected and the right
actions taken. This allows one to avoid running applets which aren't supported
on the user's machine.
</p>

<p><a href="AFCDetectInfo.htm">How to use AFC Detect in your own web pages</a>
<br><a href="AFCAutoinstall.htm">How to insure that your web page visitors have AFC installed</a></p>
<p><input type="button" name="button1" value="Is AFC Installed on your computer?" onClick="detectAFC()"></p>



<!--rule-->
<TABLE WIDTH=95%><TD HEIGHT=1 BGCOLOR=BLUE></TD></TABLE>



<!--rule tex back type>
<TABLE WIDTH=95%><TD HEIGHT=1 BACKGROUND="../../art/Stex_4.gif" BGCOLOR="WHITE"></TD></TABLE>
<BR-->


<TR><TD>
<FONT FACE="VERDANA, GEORGIA, ARIAL, HELVETICA" SIZE=4>
<B></A></B></FONT><BR>

<!-- AFC detect applet. Won't display -->
<applet 
	code=AFCDetect.class 
	name=AFCDetect 
	width=0 
	height=0>
</applet>

<FONT FACE="HELVETICA, ARIAL" SIZE=2>
<B></B>

<!--remarks 1-->
<FONT FACE="VERDANA, GEORGIA, ARIAL, HELVETICA" SIZE=2>
<B><I>Remarks:</I></B>
<BR>
<I>This sample created with Microsoft AFC.</I>

<BR>

<!--rule-->
<TABLE WIDTH=95%><TD HEIGHT=2 BGCOLOR=BLUE></TD></TABLE>
<BR>

<!--page top button-->
<TABLE WIDTH=100%><TR><TD ALIGN=LEFT><A HREF="#pagetop"><IMG SRC="../../art/butt_up.gif" WIDTH="40" HEIGHT="11"  BORDER=0 ALT="Top"></A></TD>

<!--MS copyright-->
<TD ALIGN=RIGHT><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK"><A HREF="../../art/cpyright.htm">&#169; 1996 Microsoft Corporation. All rights reserved.</A></FONT></TD></TR></TABLE>
</FONT>


<SCRIPT LANGUAGE="JavaScript">
<!--
	// this is where we do version detection

	// the "current" version of AFC as best known by this web page.
	ourAFCVersionMajor = 2
	ourAFCVersionMinor = 0

	// detects if AFC is installed. Returns 1 if so, 0 if not. Pops up message boxes
	// which tell the user whether they have an old version of AFC installed, a 
	// current version, or if it is not installed at all.
    	function detectAFC()
    	{	   	    	   		
	    // check if AFC is installed at all.
	    if (document.AFCDetect.doesSupportAFC() == 0)
		{
			alert("You don't have AFC installed on your machine.");
			return 0
		}
	    else
		{			
			alert("You currently have AFC version " + document.AFCDetect.getAFCVersionString());

			// grab AFC version numbers from the system
			afcVerMajor = document.AFCDetect.getAFCMajorVersion();
			afcVerMinor = document.AFCDetect.getAFCMinorVersion();
			isOld = 0;

			// checks version numbers
			isOld = ourAFCVersionMajor - afcVerMajor;

			if (isOld == 0)
				{
					isOld = ourAFCVersionMinor - afcVerMinor;					
				}		

			// if isOld <= 0, AFC is the same as or newer than the version this page knows about. If
			// isOld > 0, AFC is too old here.
			if (isOld <= 0)     
				{
					alert("A current version of AFC is installed on your computer.");
					return 1;
				}
			else
				{
					alert("An old version of AFC is installed on your computer. You should install AFC again.");
					return 0;
				}	
		}
    	}


//-->
</SCRIPT>



</BODY>
</HTML>

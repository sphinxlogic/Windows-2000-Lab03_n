<html>
<!--TOOLBAR_START-->
<!--TOOLBAR_EXEMPT-->
<!--TOOLBAR_END-->
  <head>
    <TITLE>XML Data Source Applet</title>
    <style>
      td    {font-size:80%;}
      xmp   {font-size:120%; background:yellow}
    </style>
  </head>
  

<BODY TOPMARGIN=0 LEFTMARGIN=40 BGCOLOR="#ffffff" LINK="#000066" VLINK="#666666" TEXT="#000000">
<FONT FACE="verdana,arial,helvetica" SIZE=2>



<table align=right>
<tr><td bgcolor=black><a href=Example3.htm>
    <font color=white onmouseover="this.style.color='gold'" 
        onmouseout="this.style.color='white'" ><b>Previous<b></font></a>
    <td bgcolor=black><a href=Example5.htm>
        <font color=white onmouseover="this.style.color='gold'" 
        onmouseout="this.style.color='white'" ><b>Next<b></font></a>
</table>

<h2>XML Data Source Applet</h2>
<h3>Example 4</h3>
<P>
This example shows how a separate SCHEMA can also be provided to further normalize
the data prior to binding.  In this example the <a href=#xmldata>customer data</a>
is more structured.  The &lt;NAME&gt; now consists of &lt;FIRST&gt;, &lt;MIDDLE&gt;
and &lt;LAST&gt; parts which are specified in random order.  Also the &lt;DATE&gt;
is now stored as separate components &lt;DAY&gt;, &lt;MONTH&gt; and &lt;YEAR&gt;.

<applet code=com.ms.xml.dso.XMLDSO.class width=100% height=40 id=xmldso mayscript=true>
    <param name="URL" value="cust.xml">
    <param name="SCHEMA" VALUE='
            <ROWSET NAME="CUSTOMER">
                <COLUMN NAME="LAST"/>
                <COLUMN NAME="FIRST"/>
                <ROWSET NAME="ORDER">
                    <COLUMN NAME="NUMBER"/>
                    <COLUMN NAME="DAY"/>
                    <COLUMN NAME="MONTH"/>
                    <COLUMN NAME="YEAR"/>
                    <ROWSET NAME="ITEM">
                        <COLUMN NAME="TITLE"/>
                        <COLUMN NAME="AUTHOR"/>
                        <COLUMN NAME="PRICE"/>
                    </>
                </>
            </>
        '>
</applet>
<table id=table datasrc=#xmldso border=2 width=100% cellpadding=3>
<tr><td valign=top><span datafld=LAST></span>, <span datafld=FIRST></span>
	<td valign=top>
		<table  border=2 width=100% cellpadding=3 
				datasrc=#xmldso datafld=ORDER>
		<tr><td valign=top><span datafld=MONTH></span>/<span datafld=DAY></span>/<span datafld=YEAR></span>
			<td valign=top><table  border=2 width=100% cellpadding=3
							datasrc=#xmldso datafld=ORDER.ITEM>
		 		<tr><td valign=top><div datafld=TITLE dataformatas=HTML>
					<td valign=top><div datafld=AUTHOR dataformatas=HTML>
					<td valign=top><div datafld=PRICE dataformatas=HTML>
			</table>
		</table>
</table>
<P>
The problem with this extra structure is that the schema generator 
now considers the &lt;NAME&gt; and &lt;DATE&gt; nodes as ROWSETS
when they are never really going to be repeated.  Having them become
ROWSETS makes it much more effort to bind to the sub-fields.  So
to avoid this extra work, you can hand-tune the schema that is
generated by removing the unwanted ROWSETS and then provide this
in a SCHEMA &lt;PARAM&gt; on the &lt;APPLET&gt; tag as follows:
<xmp id=applet>
<applet code=com.ms.xml.dso.XMLDSO.class 
    width=100% height=25 id=xmldso mayscript=true>
    <param name="URL" value="cust.xml">
    <param name="SCHEMA" VALUE='
            <ROWSET NAME="CUSTOMER">
                <COLUMN NAME="LAST"/>
                <COLUMN NAME="FIRST"/>
                <ROWSET NAME="ORDER">
                    <COLUMN NAME="NUMBER"/>
                    <COLUMN NAME="DAY"/>
                    <COLUMN NAME="MONTH"/>
                    <COLUMN NAME="YEAR"/>
                    <ROWSET NAME="ITEM">
                        <COLUMN NAME="TITLE"/>
                        <COLUMN NAME="AUTHOR"/>
                        <COLUMN NAME="PRICE"/>
                    </>
                </>
            </>
        '>
</applet>
</xmp>
The table that binds to this data is as follows:
<xmp>
<table id=table datasrc=#xmldso border=2 width=100% cellpadding=3>
<tr><td valign=top><span datafld=LAST></span>, <span datafld=FIRST></span>
	<td valign=top>
		<table  border=2 width=100% cellpadding=3 
				datasrc=#xmldso datafld=ORDER>
		<tr><td valign=top><span datafld=MONTH></span>/<span datafld=DAY></span>/<span datafld=YEAR></span>
			<td valign=top><table  border=2 width=100% cellpadding=3
							datasrc=#xmldso datafld=ORDER.ITEM>
		 		<tr><td valign=top><div datafld=TITLE dataformatas=HTML>
					<td valign=top><div datafld=AUTHOR dataformatas=HTML>
					<td valign=top><div datafld=PRICE dataformatas=HTML>
			</table>
		</table>
</table>
</xmp>
<P>
<input type=button value="Show XML Data"
    onclick='var xmldata = document.all.item("xmldata");
            if (this.value == "Show XML Data") {
                xmldata.innerText=xmldso.getXML();
                this.value="Hide XML Data";
            } else {
                xmldata.innerText="";
                this.value="Show XML Data";
            }'>
<xmp id=xmldata ></xmp>

<P>
<input type=button value="Show Schema" 
    onclick='var schema = document.all.item("schema");
            if (this.value == "Show Schema") {
                schema.innerText=xmldso.getSchema();
                this.value="Hide Schema";
            } else {
                schema.innerText="";
                this.value="Show Schema";
            }'>
<xmp id=schema ></xmp>
<P>
The <a href=XMLDSO.java>XML DSO Source Code</a> is in Java.

<p>

<FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">&#169; 1997 Microsoft Corporation. All rights reserved. <A HREF="../../art/cpyright.htm" target="_top">Legal Notices</a>.<P></FONT>


  </body>
</html>

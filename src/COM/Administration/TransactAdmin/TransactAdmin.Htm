<! Copyright (C) 1995 - 1999, Microsoft Corporation.  All rights reserved. -->
<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./DataAccess_files/filelist.xml">
<link rel=Edit-Time-Data href="./DataAccess_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Transactions</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Richard Ersek</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>Richard Ersek</o:LastAuthor>
  <o:Revision>4</o:Revision>
  <o:TotalTime>22</o:TotalTime>
  <o:Created>1999-06-04T02:06:00Z</o:Created>
  <o:LastSaved>1999-06-04T03:29:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>227</o:Words>
  <o:Characters>1298</o:Characters>
  <o:Company>Microsoft Corp.</o:Company>
  <o:Lines>10</o:Lines>
  <o:Paragraphs>2</o:Paragraphs>
  <o:CharactersWithSpaces>1594</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<link rel=Stylesheet type="text/css" media=all href="..\..\..\styles.css">
<style>
<!--
a:visited
	{color: 336666;}
A:hover {background:Olive; color: White}
 /* Font Definitions */
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:536871559 0 0 0 415 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{mso-ansi-font-size:9.0pt;
	mso-bidi-font-size:9.0pt;
	mso-ascii-font-family:Verdana;
	mso-hansi-font-family:Verdana;
	color:olive;
	mso-text-animation:none;
	mso-hide:none;
	text-decoration:none;
	text-underline:none;
	text-decoration:none;
	text-line-through:none;}
a:visited, span.MsoHyperlinkFollowed
	{mso-ansi-font-size:9.0pt;
	mso-bidi-font-size:9.0pt;
	mso-ascii-font-family:Verdana;
	mso-hansi-font-family:Verdana;
	color:blue;
	mso-text-animation:none;
	mso-hide:none;
	text-decoration:none;
	text-underline:none;
	text-decoration:none;
	text-line-through:none;}
p
	{margin-right:0in;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
code
	{mso-ascii-font-family:"Courier New";
	mso-fareast-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";
	mso-hide:none;}
kbd
	{mso-ascii-font-family:"Courier New";
	mso-fareast-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";
	mso-hide:none;}
pre
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Courier New";}
samp
	{mso-ascii-font-family:"Courier New";
	mso-fareast-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";
	mso-hide:none;}
tt
	{mso-ascii-font-family:"Courier New";
	mso-fareast-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";
	mso-hide:none;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
</head>

<body lang=EN-US link=olive vlink=blue style="tab-interval: .5in">
<DIV class=Section1>

<h2><span style="COLOR: black; FONT-FAMILY: Verdana"><o:p>TransactAdmin</o:p></span></h2>


<div class=MsoNormal align=center style="TEXT-ALIGN: center"><span
 style="COLOR: black; FONT-FAMILY: Verdana; FONT-SIZE: 9pt">

<hr size=2 width="100%" align=center>

</span></div>


<h4><span style="COLOR: black; FONT-FAMILY: Verdana">Overview<o:p></o:p></span></h4>

<p><span style="COLOR: black; FONT-FAMILY: Verdana; FONT-SIZE: 9pt">The TransactAdmin sample provides an example of using the 
COMAdmin objects to administer COM+ applications inside a transaction.&nbsp; By 
encompassing a series of changes to the catalog in a transaction, applications 
may be configured while maintaining the catalog in a consistent 
state.&nbsp;&nbsp; This benefits your applications by simplifying the cleanup 
code required.<BR><BR>Note that while changes to the regdb are transacted, any 
changes to the registry, file system and MSI are not <FONT size=2>because</FONT> 
these resources don't participate in DTC transactions.&nbsp; Therefore changes 
to these must be cleaned up manually.</span></p>
<P>&nbsp;</P>
<P><SPAN style="COLOR: black; FONT-FAMILY: Verdana; FONT-SIZE: 9pt"></SPAN><span style="COLOR: black; FONT-FAMILY: Verdana">Project Files<o:p></o:p></span></P>

<table border=0 cellpadding=0 width="75%" style="WIDTH:
 75%; mso-cellspacing: 1.5pt; mso-padding-alt: 0in 0in 0in 0in">
 <tr>
  <td width="25%" valign=top style="PADDING-BOTTOM: 0.75pt; PADDING-LEFT: 0.75pt; PADDING-RIGHT: 0.75pt; PADDING-TOP: 0.75pt; WIDTH: 25.8%" 
   >
  <p class=MsoNormal><FONT face=Verdana 
      size=2><STRONG>File</STRONG></FONT></p>
  </td>
  <td width="73%" valign=top style="PADDING-BOTTOM: 0.75pt; PADDING-LEFT: 0.75pt; PADDING-RIGHT: 0.75pt; PADDING-TOP: 0.75pt; WIDTH: 73.4%" 
   >
  <p class=MsoNormal><strong><span style="COLOR:
  black; FONT-FAMILY: Verdana; FONT-SIZE: 9pt" 
     >Description</span></strong><span style="COLOR:
  black; FONT-FAMILY: Verdana; FONT-SIZE: 9pt" 
     ><o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width="25%" valign=top style="PADDING-BOTTOM: 0.75pt; PADDING-LEFT: 0.75pt; PADDING-RIGHT: 0.75pt; PADDING-TOP: 0.75pt; WIDTH: 25.8%" 
   >
  TransactAdmin.vbp
  </td>
  <td width="73%" valign=top style="PADDING-BOTTOM: 0.75pt; PADDING-LEFT: 0.75pt; PADDING-RIGHT: 0.75pt; PADDING-TOP: 0.75pt; WIDTH: 73.4%" 
   >
  Visual Basic project file for 
      the COM+ component
  </td>
 </tr>
 <tr>
  <td width="25%" valign=top style="PADDING-BOTTOM: 0.75pt; PADDING-LEFT: 0.75pt; PADDING-RIGHT: 0.75pt; PADDING-TOP: 0.75pt; WIDTH: 25.8%" 
   >
  MkCOMApp.cls
  </td>
  <td width="73%" valign=top style="PADDING-BOTTOM: 0.75pt; PADDING-LEFT: 0.75pt; PADDING-RIGHT: 0.75pt; PADDING-TOP: 0.75pt; WIDTH: 73.4%" 
   >
  Visual Basic class file for 
      the COM+ component
  </td>
 </tr>
 <tr>
  <td width="25%" valign=top style="PADDING-BOTTOM: 0.75pt; PADDING-LEFT: 0.75pt; PADDING-RIGHT: 0.75pt; PADDING-TOP: 0.75pt; WIDTH: 25.8%" 
   >
  AdminClient.vbp
  </td>
  <td width="73%" valign=top style="PADDING-BOTTOM: 0.75pt; PADDING-LEFT: 0.75pt; PADDING-RIGHT: 0.75pt; PADDING-TOP: 0.75pt; WIDTH: 73.4%" 
   >
  Visual Basic project file for 
      the client application
  </td>
 </tr>
 <tr>
  <td width="25%" valign=top style="PADDING-BOTTOM: 0.75pt; PADDING-LEFT: 0.75pt; PADDING-RIGHT: 0.75pt; PADDING-TOP: 0.75pt; WIDTH: 25.8%" 
   >
  ClientFrm.frm
  </td>
  <td width="73%" valign=top style="PADDING-BOTTOM: 0.75pt; PADDING-LEFT: 0.75pt; PADDING-RIGHT: 0.75pt; PADDING-TOP: 0.75pt; WIDTH: 73.4%" 
   >
  <p class=MsoNormal>Visual Basic form for the client 
      User Interface</p>
  </td>
 </tr>
 <tr>
  <td width="25%" valign=top style="PADDING-BOTTOM: 0.75pt; PADDING-LEFT: 0.75pt; PADDING-RIGHT: 0.75pt; PADDING-TOP: 0.75pt; WIDTH: 25.8%" 
   >
  TransactAdmin.htm
  </td>
  <td width="73%" valign=top style="PADDING-BOTTOM: 0.75pt; PADDING-LEFT: 0.75pt; PADDING-RIGHT: 0.75pt; PADDING-TOP: 0.75pt; WIDTH: 73.4%" 
   >
  This 
helpfile
  </td>
 </tr>
</table>

<h4><span style="COLOR: black; FONT-FAMILY: Verdana">Build Notes<o:p></o:p></span></h4></DIV>

<p><FONT face=Verdana size=2>Start by building and 
installing the TransactAdmin COM+ component using the Visual Basic development 
environment and the Component Services administration tool.&nbsp; Open the 
TransactAdmin.vbp project and selecting 'Make TransactAdmin.dll' from the File 
menu.</FONT></p>
<P><FONT face=Verdana size=2>Next, run the Component Services administration 
tool to install TransactAdmin.dll as a COM+ application.&nbsp; Open the 
'Component Services', 'Computers', 'My Computer' and 'COM+ Applications' 
folders.&nbsp; Select the 'COM+ Applications' folder, right-click on it and 
choose New / Application from the popup menu.&nbsp; The COM+ Application Install 
wizard will start.&nbsp; Click 'Next' to go to the next page of the 
Wizard.&nbsp; Choose 'Create an empty application' then enter the name of the 
application and choose 'Library Application' in the Application Type frame then 
click 'Next'.&nbsp; Choose the default of 'Interactive User' for the application 
identity and click 'Next' then click 'Finish'.<BR><BR>Open the icon for the COM+ 
application you just created and select the 'Components' folder.&nbsp; 
Right-click on the folder and select 'New Component' from the popup menu.&nbsp; 
The 'COM Component Install Wizard' will start.&nbsp; Click 'Next' to 
continue.&nbsp; Select 'Install New Component' and select the location of the 
TransAdmin.dll file you created earlier.&nbsp; On the 'Install New Components' 
page, accept or review the defaults and click 'Next' then click 
'Finish'.<BR><BR>To build the client application, open the AdminClient.vbp file 
to start the Visual Basic development environment.&nbsp; Select 'Make 
AdminClient.exe' from the File menu.&nbsp; <BR></FONT></P>
<H4><FONT face=Verdana>Running the Sample</FONT></H4>
<P><FONT face=Verdana size=2>After the TransAdmin&nbsp;component DLL has been 
built and installed as a COM+ application you may run the client application, 
AdminClient.exe.<BR><BR>The&nbsp;client application allows you to create several 
new COM+ applications in a single transaction.&nbsp; Start by entering the 
application name for a new COM+ application and click on the 'Add' button.&nbsp; 
You may add additional applications to be created by entering the application 
name and clicking on 'Add' for each one.<BR><BR>To provide an example of the 
results when SetComplete or SetAbort are called in a transaction, the client 
application allows you to choose via&nbsp;its user interface.&nbsp; When you are 
ready to commit the changes, select either 'SetComplete' or 'SetAbort' from the 
'Transaction Options' frame then click 'OK'.&nbsp; These options correspond to 
calling the SetComplete or SetAbort methods on the IObjectContext interface when 
the TransAdmin component is ready to commit changes.&nbsp; Calling SetComplete 
indicates that the transaction completed successfully and commits the 
changes.&nbsp; Calling SetAbort indicates that the transaction didn't complete 
successfully and any transactional changes are rolled back.&nbsp;&nbsp; Also, if 
any errors occur while adding applications, SetAbort is automatically called 
through the error handler.<BR><BR>You may view the results of your changes by 
opening the 'COM+ Applications' folder from the Component Services 
administration tool.&nbsp; Try adding several applications in the transaction 
and observing the results when either SetComplete or SetAbort are called.&nbsp; 
It may be necessary to refresh the Component Services tool's display by pressing 
F5 each time you click 'OK' from the client application.&nbsp;&nbsp;The results 
of the transaction are also logged to the Application Event Log as VBRuntime 
events.</FONT><span
 style="COLOR: black; FONT-FAMILY: Verdana; FONT-SIZE: 9pt"></P>
<DIV class=Section1>

<hr size=2 width="100%" align=center>
</SPAN>
<P></P>


<p><span style="COLOR: black; FONT-FAMILY: Verdana; FONT-SIZE: 9pt">&nbsp;<o:p></o:p></span></p></DIV>

</body>

</html>
